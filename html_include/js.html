<script>
    /* 選單點擊 */
    const dropmenus = document.querySelectorAll("[data-dropmenu]");
    const navtoggle = document.querySelector("#nav-toggle");
    const nav = document.querySelector(".nav");
    dropmenus.forEach((element) => {
        const trigger = element.querySelector("[data-trigger]");
        trigger.addEventListener("click", (e) => {
            // 切換 --active 類別
            element.classList.toggle("--active");

            // 如果元素上有 .for-member 類別，則進行額外的操作
            if (element.classList.contains("for-member")) {
                // 移除 --active 類別
                nav.classList.remove("--active");
                navtoggle.classList.remove("--active");
            }

            e.preventDefault();
            e.stopPropagation(); // 防止事件冒泡到 document 上
        });
    });
    navtoggle.addEventListener("click", (e) => {
        // 切換 --active 類別
        navtoggle.classList.toggle("--active");
        nav.classList.toggle("--active");
        dropmenus.forEach((element) => {
            element.classList.remove("--active");
        });

        e.preventDefault();
        e.stopPropagation(); // 防止事件冒泡到 document 上
    });

    // 監聽 document 點擊事件
    document.addEventListener("click", (e) => {
        // 確認點擊的元素是否為 dropmenu 或其子元素
        const isClickInsideDropmenu = e.target.closest("[data-dropmenu]");

        // 若點擊範圍不在 dropmenu 內，則移除所有 --active 類別
        if (!isClickInsideDropmenu) {
            dropmenus.forEach((dropmenu) => {
                if (dropmenu.classList.contains("--active")) {
                    dropmenu.classList.remove("--active");
                }
            });
        }
    });
    //密碼判斷是否出現眼睛
    const body = document.querySelector("body");
    const togglePassword = document.querySelectorAll("[data-togglePassword]");
    togglePassword.forEach((element) => {
        const input = element.querySelector("input");
        const eye = element.querySelector(".eye");
        eye.addEventListener("click", function (e) {
            eye.classList.toggle("--show");
            if (input.type === "password") {
                input.type = "text";
            } else {
                input.type = "password";
            }
        });
    });

    body.addEventListener("keyup", function (e) {
        var target = e.target;
        var type = target.type;
        var parent = target.parentNode;

        if (type == "password") {
            if (target.value != "") {
                // console.log('有值');
                parent.classList.add("show-eye");
            } else {
                //console.log('空值');
                parent.classList.remove("show-eye");
            }
        } else {
        }
    });

    /*操作 modal*/
    let currentLevel = 0;
    const modals = document.querySelectorAll("[data-modal]");
    const modalBtns = document.querySelectorAll("[data-openmodal]");
    modalBtns.forEach((element) => {
        element.addEventListener("click", function (e) {
            var id = element.dataset.openmodal;
            var target = document.querySelector("#" + id);
            // currentLevel = currentLevel + 1;
            // var layerClass = "layer-" + currentLevel;
            // var showLayerClass = "has-layer-" + currentLevel;
            // currentModal = target;
            // console.log('you click ' + id);
            // console.log(target);
            // console.log(currentModal);
            target.classList.add("--active");
            // target.classList.add(layerClass);
            body.classList.add("has-modal");
            e.preventDefault();

            //           element.classList.remove('active');
            if ("autoclose" in element.dataset) {
                console.log("有的");
                setTimeout(() => {
                    target.classList.remove("active");
                    body.classList.remove("has-modal");
                }, 1500);
            } else {
            }
        });
    });

    modals.forEach((element) => {
        var modalBody = element.querySelector(".modal-container");
        var modalClose = element.querySelectorAll("[data-close]");
        var modalsBack = element.querySelector("[data-back]");

        modalClose.forEach((close) => {
            close.addEventListener("click", function () {
                element.classList.remove("--active");
                body.classList.remove("has-modal");
            });
        });
    });

    if (document.querySelector(".video-container")) {
        // 獲取影片和播放按鈕元素
        const videos = document.querySelectorAll(".video-container");

        videos.forEach((element) => {
            let video = element.querySelector("video");
            let btnPlay = element.querySelector("[data-playvideo]");
            video.pause();
            //let container = document.querySelector(".video-container");
            // 點擊播放按鈕後，影片開始播放並在 video-container 加上 --active 類別
            btnPlay.addEventListener("click", function () {
                if (video.paused) {
                    video.play();
                    element.classList.add("--active");
                } else {
                    video.pause();
                    element.classList.remove("--active");
                }
            });

            // 若影片播放時點擊暫停，則在 video-container 移除 --active 類別
            video.addEventListener("pause", function () {
                element.classList.remove("--active");
            });
        });
    }
</script>
